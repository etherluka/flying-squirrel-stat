# 자기상관성과 결손된 예측변수

시간에 따라 변하는 중요한 예측변수를 회귀모형에서 빠뜨린 경우에도 자기상관성이 나타날 수 있다. 
이런 경우에는 단순히 해당 변수를 모형에 추가해주는 것만으로 자기상관성을 해결할 수 있다. 

따라서 앞서 살펴본 변수변환과 같은 기법은 이러한 결손된 변수가 없었다는 것을 전제로 사용하는
최종 보스 느낌이다. (애초에 '순수 자기상관이 있을 때'라고 했었다.)

이번 포스팅은 내용이 너무 빈약하므로, 교재에 있는 데이터와 R을 사용해
실제로 해당 결손된 예측변수를 넣으면 문제가 해결되는지 살펴보도록 하자. 

# ■ R을 활용해 확인해보기

Ch8에 있는 'Housing Starts'라는 데이터셋을 사용했다. 
H는 주택착공수, P는 인구수(단위 100만), D는 담보융자자금이다. 

먼저 H를 P에만 적합시킨 회귀모형을 만들고, 잔차를 확인해본다.

model <- lm(H~P, data = p219) 
residuals <- resid(model)

plot(residuals, type = "b", pch = 16,
     xlab = "Observation", ylab = "Residual",
     main = "Residuals by Observation Order")
abline(h = 0, col = "red", lty = 2)

![github 1](https://github.com/user-attachments/assets/c92929a7-9d09-4959-a357-a8c6e8fa3bd6)

보다시피 꽤 명확한 자기상관성이 보인다. 더빈-왓슨 테스트의 p값도 6.645e-06이 나올만큼 뚜렷한 자기상관이 있다.

그렇다면 이번에는 D를 결손된 예측변수라고 보고, 이를 모형에 포함해보자. 

model1 <- lm(H~P+D, data = p219) 

![github 2](https://github.com/user-attachments/assets/1331754e-7975-44e2-a51b-ab69fa42c4aa)

이제는 자기상관이 보이지 않는다. 중간에 outlier처럼 보이는 점이 하나 있기는 하지만 전체적인 흐름은 꽤나 랜덤해보인다. 
더빈-왓슨 테스트 값도 0.2316으로 더 이상 유의하지 않다. 

이로써 우리는 결손딘 예측변수를 모형에 넣는 것만으로 자기상관성을 해결할 수 있다는 것을 확인해보았다.
