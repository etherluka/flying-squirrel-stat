# 가중최소제곱법(WLS) 두 번째 사례
---
이번에는 데이터 수집 방법 특성에 의해 이론적으로 미리 이분산성을 가정할 수 있는 경우에 대해 살펴볼 것이다.
말이 어렵지만, 예시는 직관적이다.

<사례>
4개의 학교에 대해 각 학교 내에서 학생들을 표본조사한 경우를 생각해본다. 

n<sub>j</sub>(j=1,2,3,4)를 특정 학교에서 뽑은 표본 학생 수라고 할 때
n<sub>1</sub>: 100명의 학생
n<sub>2</sub>: 80명의 학생
n<sub>3</sub>: 70명의 학생
n<sub>4</sub>: 10명의 학생

10명을 뽑은 학교4보다는, 100명을 조사한 학교1의 결과가 더 믿음이 간다. 가중최소제곱(WLS)는 이런 믿음을 반영하여 표본조사 수 만큼, 해당 학교의 결과에 더 힘을 실어주겠다는 의미이다.

그럼 우리 회귀모형에서 반응변수 y<sub>i</sub>가 '학교<sub>i</sub>의 평균학비'라고 해보자. 
따라서 학교1의 경우에는 100명 학생 학비의 평균, ..., 학교4는 10명의 학생 학비의 평균이, 각각 y<sub>1</sub>, y<sub>2</sub>, y<sub>3</sub>, y<sub>4</sub>가 될 것이다.
이때 표본평균 분포에 따라 이론적으로
Var(y<sub>i</sub>)= σ<sup>2</sup>/n<sub>i</sub>이 된다는 것을 알고 있다.

따라서 σᵢ<sup>2</sup>= σ<sup>2</sup>/n<sub>i</sub>가 된다.

이제 분산을 표현해낼 수 있게 되었으므로 가중치(W<sub>i</sub>)도 알 수 있다. 

### W<sub>i</sub>= 1/σᵢ<sup>2</sup> = n<sub>i</sub> / σ<sup>2</sup>

여기서 σ<sup>2</sup>는 상수이므로, 함수를 최소화할 때 영향을 주지 않는다. 
따라서
### W<sub>i</sub>= n<sub>i</sub>
으로 정의하고 모델을 적합시키도록 한다.


![KakaoTalk_20250510_144256205](https://github.com/user-attachments/assets/3d6ded0d-5aba-4702-929c-0d9f85792687)
